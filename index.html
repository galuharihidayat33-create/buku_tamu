
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Buku Tamu Wedding</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- ‚úÖ CDN stabil html5-qrcode -->
  <script src="https://cdn.jsdelivr.net/npm/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
</head>
<body class="bg-gradient-to-br from-pink-100 to-yellow-100 min-h-screen flex items-center justify-center font-sans">
  <div class="bg-white shadow-lg rounded-2xl p-6 w-full max-w-2xl">
    <h1 class="text-2xl font-bold text-center text-pink-600 mb-4">üíç Buku Tamu Pernikahan</h1>
    
    <!-- QR Scanner -->
    <div class="mb-6">
      <h2 class="text-lg font-semibold text-gray-700 mb-2">Scan Undangan (QR)</h2>
      <div id="reader" class="w-full border rounded-lg"></div>
    </div>

    <!-- Form Manual -->
    <div>
      <h2 class="text-lg font-semibold text-gray-700 mb-2">Isi Data Manual</h2>
      <form id="guestForm" class="space-y-3">
        <input type="text" id="nama" placeholder="Nama Tamu" class="w-full border rounded-lg p-2" required>
        <input type="number" id="jumlah" placeholder="Jumlah Tamu" class="w-full border rounded-lg p-2" min="1" required>
        <textarea id="ucapan" placeholder="Ucapan untuk pengantin" class="w-full border rounded-lg p-2"></textarea>
        <button type="submit" class="w-full bg-pink-500 text-white py-2 rounded-lg hover:bg-pink-600">
          Simpan
        </button>
      </form>
    </div>

    <!-- List Tamu -->
    <div class="mt-6">
      <h2 class="text-lg font-semibold text-gray-700 mb-2">Daftar Tamu</h2>
      <table class="w-full border text-sm">
        <thead>
          <tr class="bg-pink-200">
            <th class="p-2 border">Nama</th>
            <th class="p-2 border">Jumlah</th>
            <th class="p-2 border">Ucapan</th>
          </tr>
        </thead>
        <tbody id="guestList"></tbody>
      </table>
    </div>
  </div>

  <script>
    const form = document.getElementById("guestForm");
    const guestList = document.getElementById("guestList");
    let tamu = JSON.parse(localStorage.getItem("weddingGuests")) || [];

    function renderGuests() {
      guestList.innerHTML = "";
      tamu.forEach(g => {
        guestList.innerHTML += `
          <tr>
            <td class="border p-2">${g.nama}</td>
            <td class="border p-2 text-center">${g.jumlah}</td>
            <td class="border p-2">${g.ucapan || "-"}</td>
          </tr>
        `;
      });
    }

    form.addEventListener("submit", e => {
      e.preventDefault();
      const nama = document.getElementById("nama").value;
      const jumlah = document.getElementById("jumlah").value;
      const ucapan = document.getElementById("ucapan").value;
      tamu.push({nama, jumlah, ucapan});
      localStorage.setItem("weddingGuests", JSON.stringify(tamu));
      form.reset();
      renderGuests();
    });

    renderGuests();

    // ‚úÖ QR Scanner dengan handling error
    document.addEventListener("DOMContentLoaded", () => {
      if (typeof Html5Qrcode === "undefined") {
        alert("‚ö†Ô∏è Gagal memuat library scanner. Cek koneksi internet!");
        return;
      }

      const qrScanner = new Html5Qrcode("reader");
      qrScanner.start(
        { facingMode: "environment" },
        { fps: 10, qrbox: 200 },
        (decodedText) => {
          alert("QR Terdeteksi: " + decodedText);
          tamu.push({nama: decodedText, jumlah: 1, ucapan: ""});
          localStorage.setItem("weddingGuests", JSON.stringify(tamu));
          renderGuests();
          qrScanner.stop();
        },
        (errorMessage) => { /* abaikan error kecil */ }
      ).catch(err => console.error("Gagal memulai scanner:", err));
    });
  </script>
</body>
</html>


