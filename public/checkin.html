<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Check-in Buku Tamu</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">
  <div class="bg-white p-6 rounded-xl shadow w-full max-w-md text-center">
    <h1 class="text-xl font-bold mb-4">ðŸ“· Scan QR Tamu</h1>
    <div id="reader" style="width:300px" class="mx-auto"></div>
    <div id="result" class="mt-4 text-lg font-bold text-green-600"></div>
  </div>

  <script>
    function onScanSuccess(decodedText) {
      const data = JSON.parse(decodedText);
      document.getElementById("result").innerText = `âœ… ${data.nama} (${data.jumlah} orang) hadir`;

      // Update status hadir
      fetch('/api/checkin', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ id: data.id })
      });
    }

    new Html5Qrcode("reader").start(
      { facingMode: "environment" },
      { fps: 10, qrbox: 250 },
      onScanSuccess
    );
  </script>
</body>
</html>
